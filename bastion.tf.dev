module "bastion" {
  source = "git@github.com:code-snipes/tf-oci-modules.git//bastion"

  compartment_id = "ocid1.compartment.oc1..aaaaaaaaensqjpvvvudpci3mubpsh3k5am7ftujsngn3reh3fjgpja2h37sq"
  vcn_id         = "ocid1.vcn.oc1.iad.amaaaaaanilxufianppjygzpznnksymz6lguuboshu6smxe46low3dx3f5vq"
  subnet_id      = "ocid1.subnet.oc1.iad.aaaaaaaaujiza35rvufevk6jd4q26nglzw7i6dkkjkbmkf47mq6aflel5abq"
  ig_route_id    = ""

  tenancy_id           = var.tenancy_ocid
  user_id              = var.user_ocid
  api_fingerprint      = var.fingerprint
  api_private_key_path = var.private_key_path
  region               = var.region

  availability_domain = 1

  bastion_enabled  = false
  bastion_access   = "ANYWHERE"
  bastion_upgrade  = false
  bastion_image_id = "Autonomous"
  bastion_shape = {
    "boot_volume_size" : 50,
    "memory" : 4,
    "ocpus" : 1,
    "shape" : "VM.Standard.E3.Flex"
  }

  label_prefix = var.label_prefix

  netnum  = 32
  newbits = 13

  notification_enabled  = false
  notification_endpoint = "<email_address>"
  notification_protocol = "EMAIL"
  notification_topic    = "bastion_server_notification"

  ssh_public_key_path = "../keys/bastion_id.pub"

  tags = {
    "department" : "CCoE",
    "environment" : "PoC",
  "role" : "bastion" }
  timezone = "UTC"
}
